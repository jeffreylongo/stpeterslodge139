import{c as Y,v as o,w as T,x as F,r as f,y as B,g as H,u as L,i as q,j as e,N as K,L as $,C as O,A as p,f as P,D as Q,b as U,M as V,B as W,R as G,F as J,s as X}from"./index-DNn8QZoh.js";import{E as Z}from"./external-link-UdEYCnrF.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=Y("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=Y("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);function R(s,n){const a=o(s);if(isNaN(n))return T(s,NaN);if(!n)return a;const i=a.getDate(),c=T(s,a.getTime());c.setMonth(a.getMonth()+n+1,0);const h=c.getDate();return i>=h?c:(a.setFullYear(c.getFullYear(),c.getMonth(),i),a)}function se(s,n){const a=F(s),i=F(n);return+a==+i}function ae(s){const n=o(s),a=n.getMonth();return n.setFullYear(n.getFullYear(),a+1,0),n.setHours(23,59,59,999),n}function ne(s,n){const a=o(s.start),i=o(s.end);let c=+a>+i;const h=c?+a:+i,m=c?i:a;m.setHours(0,0,0,0);let y=1;const x=[];for(;+m<=h;)x.push(o(m)),m.setDate(m.getDate()+y),m.setHours(0,0,0,0);return c?x.reverse():x}function re(s){const n=o(s);return n.setDate(1),n.setHours(0,0,0,0),n}function ie(s){return o(s).getDay()}function le(s,n){const a=o(s),i=o(n);return a.getFullYear()===i.getFullYear()&&a.getMonth()===i.getMonth()}function ce(s,n){const a=o(s),i=o(n);return a.getFullYear()===i.getFullYear()}function de(s,n){return R(s,-n)}const ge=()=>{const[s,n]=f.useState(new Date),[a,i]=f.useState([1,2]),[c,h]=f.useState([]),[m,y]=f.useState(!1),x=B(),{toast:w}=H(),{data:D,isLoading:_}=L({queryKey:["/api/events"]}),{data:j,isLoading:z}=L({queryKey:["/api/calendars"]}),u=q({mutationFn:()=>X("/api/calendars/sync",{method:"POST",headers:{"Content-Type":"application/json"}}),onSuccess:t=>{x.invalidateQueries({queryKey:["/api/events"]}),m||(w({title:"Calendars Synced",description:`Successfully imported ${t.count} new events.`}),y(!0))},onError:()=>{w({title:"Sync Failed",description:"Failed to sync calendar events. Please try again later.",variant:"destructive"})}}),S=_||z||u.isPending;f.useEffect(()=>{u.mutate()},[]),console.log("Current date for filtering:",s),console.log("Selected calendars:",a);const M=D?D.filter(t=>{const r=new Date(t.date);return isNaN(r.getTime())?(console.log("Skipping event with invalid date:",t.title),!1):a.length===0||a.includes(t.calendarId)}):[],C=new Date,k=new Date;k.setDate(C.getDate()+10);const N=M.filter(t=>{const r=new Date(t.date);return r>=C&&r<=k}).sort((t,r)=>{const l=new Date(t.date),d=new Date(r.date);return isNaN(l.getTime())||isNaN(d.getTime())?0:l.getTime()-d.getTime()});console.log("Filtered events count:",N.length);const A=(()=>{const t=re(s),r=ae(s),v=ne({start:t,end:r}),g=ie(t);return[...Array(g).fill(null),...v]})(),b=(()=>{const t={};return M.forEach(r=>{const l=new Date(r.date);if(isNaN(l.getTime())||!le(l,s)||!ce(l,s))return;const d=p(l,"yyyy-MM-dd");t[d]||(t[d]=[]),t[d].push(r)}),t})(),I=t=>{a.includes(t)?i(a.filter(r=>r!==t)):i([...a,t])},E=t=>{c.includes(t)?h(c.filter(r=>r!==t)):h([...c,t])};return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(K,{}),e.jsxs("main",{className:"flex-grow",children:[e.jsx("div",{className:"bg-primary-blue-dark text-white py-16",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-4",children:[e.jsx($,{to:"/",children:e.jsx("div",{className:"hover:text-primary-gold transition",children:"Home"})}),e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{className:"text-primary-gold",children:"Calendar"})]}),e.jsx("h1",{className:"font-cinzel text-4xl md:text-5xl font-bold",children:"Lodge Calendar"}),e.jsx("p",{className:"mt-4 text-xl",children:"Stay updated with upcoming meetings and events"})]})}),e.jsx("div",{className:"container mx-auto px-4 py-12",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsxs("div",{className:"w-full lg:w-2/3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("button",{onClick:()=>n(de(s,1)),className:"p-2 hover:bg-neutral-light rounded-full transition",children:e.jsx(ee,{className:"h-5 w-5"})}),e.jsx("h2",{className:"font-cinzel text-2xl font-bold",children:p(s,"MMMM yyyy")}),e.jsx("button",{onClick:()=>n(R(s,1)),className:"p-2 hover:bg-neutral-light rounded-full transition",children:e.jsx(O,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-8",children:[e.jsx("div",{className:"grid grid-cols-7 bg-primary-blue text-white",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(t=>e.jsx("div",{className:"p-3 text-center font-medium",children:t},t))}),e.jsx("div",{className:"grid grid-cols-7",children:A.map((t,r)=>{const l=t?p(t,"yyyy-MM-dd"):"",d=t&&b[l]&&b[l].length>0,v=t&&se(t,new Date);return e.jsx("div",{className:`min-h-24 p-2 border border-gray-100 ${t?"":"bg-gray-50"}`,children:t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`text-right ${v?"bg-primary-gold text-white rounded-full w-8 h-8 flex items-center justify-center ml-auto":""}`,children:p(t,"d")}),d&&e.jsx("div",{className:"mt-1 space-y-1",children:b[l].map(g=>e.jsx("div",{className:"bg-primary-blue-lighter rounded p-1 text-xs text-primary-blue cursor-pointer",onClick:()=>E(g.id),children:g.title},g.id))})]})},r)})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"bg-primary-blue text-white p-4",children:e.jsx("h3",{className:"font-cinzel text-xl font-bold",children:"Upcoming Events (Next 10 Days)"})}),e.jsx("div",{className:"divide-y",children:S?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-blue"})}):N.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(P,{className:"mx-auto h-12 w-12 text-gray-300 mb-4"}),e.jsx("p",{children:"No events scheduled for the next 10 days"}),e.jsx("p",{className:"mt-2 text-sm",children:"Try clicking the Sync button to fetch the latest events from our calendars."})]}):N.map(t=>{const r=c.includes(t.id),l=new Date(t.date),d=!isNaN(l.getTime());return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start cursor-pointer",onClick:()=>E(t.id),children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg",children:t.title}),e.jsx("p",{className:"text-gray-600",children:d?p(l,"EEEE, MMMM d, yyyy"):"Date not available"})]}),e.jsx("button",{className:"p-1 rounded-full hover:bg-neutral-light transition",children:r?e.jsx(te,{className:"h-5 w-5"}):e.jsx(Q,{className:"h-5 w-5"})})]}),r&&e.jsx("div",{className:"mt-4 pl-4 border-l-2 border-primary-blue-lighter",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(U,{className:"text-primary-gold mt-1 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Time"}),e.jsxs("p",{children:[t.startTime," - ",t.endTime]})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(V,{className:"text-primary-gold mt-1 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Location"}),e.jsx("p",{children:t.location})]})]}),t.description&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"font-medium",children:"Description"}),e.jsx("p",{className:"text-gray-600 mt-1",children:t.description})]})]})})]},t.id)})})]})]}),e.jsxs("div",{className:"w-full lg:w-1/3",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-8",children:[e.jsxs("div",{className:"bg-primary-blue text-white p-4 flex justify-between items-center",children:[e.jsx("h3",{className:"font-cinzel text-xl font-bold",children:"Calendar Sources"}),e.jsxs(W,{variant:"outline",size:"sm",className:"text-white border-white hover:bg-primary-blue-dark",onClick:()=>{y(!1),localStorage.removeItem("initialCalendarLoadDone"),u.mutate()},disabled:u.isPending,children:[e.jsx(G,{className:`h-4 w-4 mr-2 ${u.isPending?"animate-spin":""}`}),"Sync"]})]}),e.jsx("div",{className:"p-4",children:S?e.jsx("div",{className:"flex justify-center p-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-blue"})}):e.jsx("div",{className:"space-y-3",children:j&&Array.isArray(j)&&j.map(t=>e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.length===0||a.includes(t.id),onChange:()=>I(t.id),className:"form-checkbox h-5 w-5 text-primary-blue rounded"}),e.jsx("span",{className:"ml-2 inline-block w-4 h-4 rounded-full",style:{backgroundColor:t.color}}),e.jsx("span",{className:"ml-2",children:t.name})]})},t.id))})})]}),e.jsxs("div",{className:"bg-neutral-light p-6 rounded-lg shadow-md mb-8",children:[e.jsx("h3",{className:"font-cinzel text-xl text-primary-blue font-bold mb-4",children:"Regular Meetings"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(P,{className:"text-primary-gold mt-1 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Stated Communications"}),e.jsx("p",{children:"Third Tuesday of each month"}),e.jsx("p",{children:"Dinner at 6:30 PM | Meeting at 7:30 PM"}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Location: ",e.jsx("span",{className:"font-medium",children:"3325 1st St N, St. Petersburg, FL 33704"})]})]})]})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-md overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"font-cinzel text-xl text-primary-blue font-bold mb-4",children:"Subscribe to Our Calendar"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"You can add our calendar to your own calendar application by subscribing to our ICS feed."}),e.jsxs("a",{href:"#",className:"inline-flex items-center text-primary-blue hover:text-primary-gold transition",children:[e.jsx("span",{children:"Add to your calendar"}),e.jsx(Z,{className:"ml-2 h-4 w-4"})]})]})})]})]})})]}),e.jsx(J,{})]})};export{ge as default};
